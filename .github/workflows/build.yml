name: Build Engine

on: [push, pull_request]

jobs:
  build:
    name: ${{ matrix.config.name }}
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        os: [ 'ubuntu' ]
    steps:
      - name: Checkout 🛎️
        uses: actions/checkout@v2
        with:
          persist-credentials: false
      - name: Install cmake git and build-essential
        run: sudo apt-get install build-essential cmake git
      - name: Apt Update
        run: sudo apt-get update
      # - name: Add Mingw-64 Apt Repo
      #   run: sudo add-apt-repository ppa:tobydox/mingw-x-trusty
      # - name: Install Mingw dependencies
      #   run: >
      #     sudo apt-get install mingw-x-binutils mingw-x-gcc
      #     mingw-x-runtime mingw-x-w32api
      - name: Install build dependencies
        run: >
          sudo apt-get install libogg-dev libvorbis-dev libfreetype6-dev 
          p7zip-full libxcursor-dev libboost-thread-dev libboost-regex-dev 
          libboost-system-dev libboost-program-options-dev libboost-signals-dev 
          libboost-chrono-dev libboost-filesystem-dev libunwind8-dev default-jdk 
          libcurl4-gnutls-dev
      - name: Setup cross-compile folders
        run: mkdir -p ~/spring-xcompile/win64 ~/spring-xcompile/linux
      - name: CMake
        run: cmake .
      - name: Make Engine
        run: make spring
